version: '{build}'
configuration: Release
nuget:
  disable_publish_on_pr: true
before_build:
- cmd: dotnet restore
build:
  verbosity: minimal
after_build:
- cmd: >-
    set BUILD_NUMBER=%APPVEYOR_BUILD_NUMBER%

    dotnet pack src/PingPongr -c Release --version-suffix "%BUILD_NUMBER%"

    dotnet pack src/PingPongr.Serialization.JsonNet -c Release --version-suffix "%BUILD_NUMBER%"
test_script:
- cmd: dotnet test src/PingPongr.Tests
artifacts:
- path: '**\*.nupkg'
deploy:
- provider: NuGet
  api_key:
    secure: hHVEMlRiRYLMYn1liS1lfX1jpfrOJC5+OOmCcxy8F25tXop5PRrs4y0ll5y8kAvq
  on:
    branch: master